<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PanelX - Cloud Control Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .sidebar-collapsed {
            width: 80px;
        }
        .sidebar-collapsed .nav-text {
            display: none;
        }
        .sidebar-collapsed .logo-text {
            display: none;
        }
        .sidebar-collapsed .nav-item {
            justify-content: center;
        }
        .terminal-line::before {
            content: "$ ";
            color: #4ade80;
        }
        .log-entry.info {
            border-left: 3px solid #60a5fa;
        }
        .log-entry.warn {
            border-left: 3px solid #fbbf24;
        }
        .log-entry.error {
            border-left: 3px solid #f87171;
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-100 flex h-screen overflow-hidden">
    <!-- Sidebar -->
    <aside id="sidebar" class="bg-slate-800 w-64 flex-shrink-0 flex flex-col transition-all duration-300 ease-in-out">
        <div class="p-4 flex items-center space-x-3 border-b border-slate-700">
            <div class="bg-blue-500 p-2 rounded-lg">
                <i data-lucide="cpu" class="w-6 h-6 text-white"></i>
            </div>
            <h1 class="logo-text text-xl font-bold">PanelX</h1>
        </div>
        
        <nav class="flex-1 overflow-y-auto p-4 space-y-2">
            <a href="#" class="nav-item flex items-center space-x-3 p-3 rounded-lg bg-slate-700 text-blue-400" data-section="dashboard">
                <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                <span class="nav-text">Dashboard</span>
            </a>
            <a href="#" class="nav-item flex items-center space-x-3 p-3 rounded-lg hover:bg-slate-700" data-section="projects">
                <i data-lucide="folder" class="w-5 h-5"></i>
                <span class="nav-text">Projects</span>
            </a>
            <a href="#" class="nav-item flex items-center space-x-3 p-3 rounded-lg hover:bg-slate-700" data-section="services">
                <i data-lucide="server" class="w-5 h-5"></i>
                <span class="nav-text">Services</span>
            </a>
            <a href="#" class="nav-item flex items-center space-x-3 p-3 rounded-lg hover:bg-slate-700" data-section="terminal">
                <i data-lucide="terminal" class="w-5 h-5"></i>
                <span class="nav-text">Terminal</span>
            </a>
            <a href="#" class="nav-item flex items-center space-x-3 p-3 rounded-lg hover:bg-slate-700" data-section="logs">
                <i data-lucide="file-text" class="w-5 h-5"></i>
                <span class="nav-text">Logs</span>
            </a>
        </nav>
        
        <div class="p-4 border-t border-slate-700">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 rounded-full bg-slate-600 flex items-center justify-center">
                    <i data-lucide="user" class="w-5 h-5"></i>
                </div>
                <div class="nav-text">
                    <div class="font-medium">Admin User</div>
                    <div class="text-xs text-slate-400">admin@panelx.com</div>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col overflow-hidden">
        <!-- Top Bar -->
        <header class="bg-slate-800 border-b border-slate-700 p-4 flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <button id="sidebar-toggle" class="text-slate-400 hover:text-white">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>
                <h2 class="text-xl font-semibold">Dashboard</h2>
            </div>
            
            <div class="flex items-center space-x-4">
                <div class="relative">
                    <i data-lucide="bell" class="w-5 h-5 text-slate-400 hover:text-white cursor-pointer"></i>
                    <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-2 h-2 rounded-full bg-emerald-400 animate-pulse"></div>
                    <span class="text-sm">Connected</span>
                </div>
            </div>
        </header>

        <!-- Dashboard Content -->
        <main class="flex-1 overflow-y-auto p-6">
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-slate-400 text-sm">CPU Usage</p>
                            <h3 class="text-2xl font-bold mt-1">42%</h3>
                        </div>
                        <div class="p-2 rounded-lg bg-blue-500/10">
                            <i data-lucide="cpu" class="w-6 h-6 text-blue-500"></i>
                        </div>
                    </div>
                    <div class="mt-4 h-2 w-full bg-slate-700 rounded-full overflow-hidden">
                        <div class="h-full bg-blue-500 rounded-full" style="width: 42%"></div>
                    </div>
                </div>
                
                <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-slate-400 text-sm">Memory Usage</p>
                            <h3 class="text-2xl font-bold mt-1">5.2/16 GB</h3>
                        </div>
                        <div class="p-2 rounded-lg bg-emerald-400/10">
                            <i data-lucide="memory-stick" class="w-6 h-6 text-emerald-400"></i>
                        </div>
                    </div>
                    <div class="mt-4 h-2 w-full bg-slate-700 rounded-full overflow-hidden">
                        <div class="h-full bg-emerald-400 rounded-full" style="width: 32.5%"></div>
                    </div>
                </div>
                
                <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-slate-400 text-sm">Disk Usage</p>
                            <h3 class="text-2xl font-bold mt-1">120/500 GB</h3>
                        </div>
                        <div class="p-2 rounded-lg bg-purple-500/10">
                            <i data-lucide="hard-drive" class="w-6 h-6 text-purple-500"></i>
                        </div>
                    </div>
                    <div class="mt-4 h-2 w-full bg-slate-700 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-500 rounded-full" style="width: 24%"></div>
                    </div>
                </div>
                
                <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-slate-400 text-sm">Network</p>
                            <h3 class="text-2xl font-bold mt-1">3.2 MB/s</h3>
                        </div>
                        <div class="p-2 rounded-lg bg-amber-500/10">
                            <i data-lucide="network" class="w-6 h-6 text-amber-500"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="flex items-center space-x-2 text-sm">
                            <i data-lucide="arrow-down" class="w-4 h-4 text-amber-500"></i>
                            <span>1.5 MB/s</span>
                            <i data-lucide="arrow-up" class="w-4 h-4 text-blue-500 ml-4"></i>
                            <span>1.7 MB/s</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-semibold">CPU & Memory Usage</h3>
                        <div class="flex space-x-2">
                            <button class="text-xs px-3 py-1 bg-slate-700 rounded-lg">1h</button>
                            <button class="text-xs px-3 py-1 bg-blue-500 rounded-lg">24h</button>
                            <button class="text-xs px-3 py-1 bg-slate-700 rounded-lg">7d</button>
                        </div>
                    </div>
                    <div class="h-64">
                        <canvas id="cpuMemoryChart"></canvas>
                    </div>
                </div>
                
                <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-semibold">Network Traffic</h3>
                        <div class="flex space-x-2">
                            <button class="text-xs px-3 py-1 bg-slate-700 rounded-lg">1h</button>
                            <button class="text-xs px-3 py-1 bg-blue-500 rounded-lg">24h</button>
                            <button class="text-xs px-3 py-1 bg-slate-700 rounded-lg">7d</button>
                        </div>
                    </div>
                    <div class="h-64">
                        <canvas id="networkChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Projects Section -->
            <div class="bg-slate-800 rounded-2xl p-6 shadow-lg mb-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="font-semibold text-lg">Your Projects</h3>
                    <button class="flex items-center space-x-2 bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg transition-colors">
                        <i data-lucide="plus" class="w-4 h-4"></i>
                        <span>New Project</span>
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Project Card -->
                    <div class="bg-slate-700/50 rounded-xl p-4 border border-slate-700 hover:border-slate-600 transition-colors">
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-medium">E-commerce Platform</h4>
                                <p class="text-sm text-slate-400 mt-1">nextjs, postgres, redis</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 rounded-full bg-emerald-400"></div>
                                <span class="text-xs">Running</span>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-slate-700 flex justify-between">
                            <div class="text-xs flex items-center space-x-2 text-slate-400">
                                <i data-lucide="clock" class="w-3 h-3"></i>
                                <span>Updated 2h ago</span>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-slate-400 hover:text-blue-400">
                                    <i data-lucide="play" class="w-4 h-4"></i>
                                </button>
                                <button class="text-slate-400 hover:text-red-400">
                                    <i data-lucide="stop-circle" class="w-4 h-4"></i>
                                </button>
                                <button class="text-slate-400 hover:text-white">
                                    <i data-lucide="settings" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Project Card -->
                    <div class="bg-slate-700/50 rounded-xl p-4 border border-slate-700 hover:border-slate-600 transition-colors">
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-medium">API Gateway</h4>
                                <p class="text-sm text-slate-400 mt-1">nodejs, mongodb</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 rounded-full bg-amber-400"></div>
                                <span class="text-xs">Restarting</span>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-slate-700 flex justify-between">
                            <div class="text-xs flex items-center space-x-2 text-slate-400">
                                <i data-lucide="clock" class="w-3 h-3"></i>
                                <span>Updated 5m ago</span>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-slate-400 hover:text-blue-400">
                                    <i data-lucide="play" class="w-4 h-4"></i>
                                </button>
                                <button class="text-slate-400 hover:text-red-400">
                                    <i data-lucide="stop-circle" class="w-4 h-4"></i>
                                </button>
                                <button class="text-slate-400 hover:text-white">
                                    <i data-lucide="settings" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Project Card -->
                    <div class="bg-slate-700/50 rounded-xl p-4 border border-slate-700 hover:border-slate-600 transition-colors">
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-medium">Analytics Dashboard</h4>
                                <p class="text-sm text-slate-400 mt-1">react, python, mysql</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 rounded-full bg-red-400"></div>
                                <span class="text-xs">Stopped</span>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-slate-700 flex justify-between">
                            <div class="text-xs flex items-center space-x-2 text-slate-400">
                                <i data-lucide="clock" class="w-3 h-3"></i>
                                <span>Updated 1d ago</span>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-slate-400 hover:text-blue-400">
                                    <i data-lucide="play" class="w-4 h-4"></i>
                                </button>
                                <button class="text-slate-400 hover:text-red-400">
                                    <i data-lucide="stop-circle" class="w-4 h-4"></i>
                                </button>
                                <button class="text-slate-400 hover:text-white">
                                    <i data-lucide="settings" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                <h3 class="font-semibold text-lg mb-6">Recent Activity</h3>
                
                <div class="space-y-4">
                    <div class="flex items-start space-x-3">
                        <div class="p-2 bg-blue-500/10 rounded-lg">
                            <i data-lucide="zap" class="w-4 h-4 text-blue-500"></i>
                        </div>
                        <div>
                            <p class="font-medium">Project "E-commerce Platform" deployed</p>
                            <p class="text-sm text-slate-400 mt-1">New version (v1.2.0) successfully deployed to production</p>
                            <p class="text-xs text-slate-500 mt-2">10 minutes ago</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start space-x-3">
                        <div class="p-2 bg-emerald-400/10 rounded-lg">
                            <i data-lucide="check-circle" class="w-4 h-4 text-emerald-400"></i>
                        </div>
                        <div>
                            <p class="font-medium">Database backup completed</p>
                            <p class="text-sm text-slate-400 mt-1">Nightly backup of production database completed successfully</p>
                            <p class="text-xs text-slate-500 mt-2">2 hours ago</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start space-x-3">
                        <div class="p-2 bg-amber-500/10 rounded-lg">
                            <i data-lucide="alert-triangle" class="w-4 h-4 text-amber-500"></i>
                        </div>
                        <div>
                            <p class="font-medium">High CPU usage detected</p>
                            <p class="text-sm text-slate-400 mt-1">CPU usage reached 90% on worker-3. Auto-scaling triggered.</p>
                            <p class="text-xs text-slate-500 mt-2">5 hours ago</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Terminal Modal (hidden by default) -->
    <div id="terminal-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center hidden">
        <div class="bg-slate-800 rounded-2xl w-full max-w-4xl h-[80vh] flex flex-col shadow-xl">
            <div class="p-4 border-b border-slate-700 flex justify-between items-center">
                <h3 class="font-semibold">Terminal - E-commerce Platform</h3>
                <button id="close-terminal" class="text-slate-400 hover:text-white">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <div id="terminal-content" class="flex-1 overflow-y-auto p-4 font-mono text-sm bg-slate-900 text-green-100">
                <div class="terminal-line">Welcome to PanelX Terminal</div>
                <div class="terminal-line">Connected to container: ecommerce-platform-web-1</div>
                <div class="terminal-line">root@ecommerce-platform:~# npm run start</div>
                <div class="terminal-line">> ecommerce-platform@1.2.0 start</div>
                <div class="terminal-line">> next start -p 3000</div>
                <div class="terminal-line">ready - started server on 0.0.0.0:3000, url: http://localhost:3000</div>
                <div class="terminal-line">info  - Loaded env from /app/.env</div>
                <div class="terminal-line">event - compiled client and server successfully in 245 ms (27 modules)</div>
            </div>
            <div class="p-4 border-t border-slate-700">
                <div class="flex items-center space-x-2">
                    <input type="text" class="flex-1 bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Type command...">
                    <button class="bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg">Send</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Logs Modal (hidden by default) -->
    <div id="logs-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center hidden">
        <div class="bg-slate-800 rounded-2xl w-full max-w-4xl h-[80vh] flex flex-col shadow-xl">
            <div class="p-4 border-b border-slate-700 flex justify-between items-center">
                <h3 class="font-semibold">Logs - E-commerce Platform</h3>
                <div class="flex items-center space-x-4">
                    <div class="flex space-x-2">
                        <button class="text-xs px-3 py-1 bg-blue-500 rounded-lg">All</button>
                        <button class="text-xs px-3 py-1 bg-slate-700 rounded-lg">Info</button>
                        <button class="text-xs px-3 py-1 bg-slate-700 rounded-lg">Warn</button>
                        <button class="text-xs px-3 py-1 bg-slate-700 rounded-lg">Error</button>
                    </div>
                    <button id="close-logs" class="text-slate-400 hover:text-white">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
            <div id="logs-content" class="flex-1 overflow-y-auto p-4 font-mono text-sm bg-slate-900">
                <div class="log-entry info pl-3 mb-2">
                    <div class="text-blue-400">[INFO] 2023-11-15 08:42:15</div>
                    <div>Server started on port 3000</div>
                </div>
                <div class="log-entry info pl-3 mb-2">
                    <div class="text-blue-400">[INFO] 2023-11-15 08:42:18</div>
                    <div>Connected to database at postgres://user@db:5432</div>
                </div>
                <div class="log-entry warn pl-3 mb-2">
                    <div class="text-amber-400">[WARN] 2023-11-15 08:43:22</div>
                    <div>Cache miss for key: user:1234:profile</div>
                </div>
                <div class="log-entry info pl-3 mb-2">
                    <div class="text-blue-400">[INFO] 2023-11-15 08:45:01</div>
                    <div>Processing checkout for order #10042</div>
                </div>
                <div class="log-entry error pl-3 mb-2">
                    <div class="text-red-400">[ERROR] 2023-11-15 08:45:03</div>
                    <div>Payment gateway timeout (5000ms exceeded)</div>
                </div>
                <div class="log-entry info pl-3 mb-2">
                    <div class="text-blue-400">[INFO] 2023-11-15 08:45:05</div>
                    <div>Retrying payment for order #10042 (attempt 1/3)</div>
                </div>
            </div>
            <div class="p-4 border-t border-slate-700 flex items-center justify-between">
                <div class="text-sm text-slate-400">Streaming logs in real-time...</div>
                <button class="flex items-center space-x-2 bg-slate-700 hover:bg-slate-600 px-4 py-2 rounded-lg">
                    <i data-lucide="download" class="w-4 h-4"></i>
                    <span>Export</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();
        
        // Navigation function to show different sections
        function showSection(section) {
            console.log('Navigating to:', section);
            
            // Update page title
            const pageTitle = document.querySelector('h2');
            const mainContent = document.querySelector('main');
            
            if (pageTitle) {
                switch(section) {
                    case 'dashboard':
                        pageTitle.textContent = 'Dashboard';
                        showDashboardContent(mainContent);
                        break;
                    case 'projects':
                        pageTitle.textContent = 'Projects';
                        showProjectsContent(mainContent);
                        break;
                    case 'services':
                        pageTitle.textContent = 'Services';
                        showServicesContent(mainContent);
                        break;
                    case 'terminal':
                        pageTitle.textContent = 'Terminal';
                        openTerminalModal();
                        return;
                    case 'logs':
                        pageTitle.textContent = 'Logs';
                        openLogsModal();
                        return;
                    default:
                        pageTitle.textContent = 'Dashboard';
                        showDashboardContent(mainContent);
                }
            }
            
            // Show notification
            showNotification(`Navigated to ${section.charAt(0).toUpperCase() + section.slice(1)}`, 'success');
        }
        
        // Show dashboard content (original content)
        function showDashboardContent(mainContent) {
            if (!mainContent) return;
            
            mainContent.innerHTML = `
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-slate-400 text-sm">CPU Usage</p>
                                <h3 class="text-2xl font-bold mt-1">42%</h3>
                            </div>
                            <div class="p-2 rounded-lg bg-blue-500/10">
                                <i data-lucide="cpu" class="w-6 h-6 text-blue-500"></i>
                            </div>
                        </div>
                        <div class="mt-4 h-2 w-full bg-slate-700 rounded-full overflow-hidden">
                            <div class="h-full bg-blue-500 rounded-full" style="width: 42%"></div>
                        </div>
                    </div>
                    
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-slate-400 text-sm">Memory Usage</p>
                                <h3 class="text-2xl font-bold mt-1">5.2/16 GB</h3>
                            </div>
                            <div class="p-2 rounded-lg bg-emerald-400/10">
                                <i data-lucide="memory-stick" class="w-6 h-6 text-emerald-400"></i>
                            </div>
                        </div>
                        <div class="mt-4 h-2 w-full bg-slate-700 rounded-full overflow-hidden">
                            <div class="h-full bg-emerald-400 rounded-full" style="width: 32.5%"></div>
                        </div>
                    </div>
                    
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-slate-400 text-sm">Disk Usage</p>
                                <h3 class="text-2xl font-bold mt-1">120/500 GB</h3>
                            </div>
                            <div class="p-2 rounded-lg bg-purple-500/10">
                                <i data-lucide="hard-drive" class="w-6 h-6 text-purple-500"></i>
                            </div>
                        </div>
                        <div class="mt-4 h-2 w-full bg-slate-700 rounded-full overflow-hidden">
                            <div class="h-full bg-purple-500 rounded-full" style="width: 24%"></div>
                        </div>
                    </div>
                    
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-slate-400 text-sm">Network</p>
                                <h3 class="text-2xl font-bold mt-1">3.2 MB/s</h3>
                            </div>
                            <div class="p-2 rounded-lg bg-amber-500/10">
                                <i data-lucide="network" class="w-6 h-6 text-amber-500"></i>
                            </div>
                        </div>
                        <div class="mt-4">
                            <div class="flex items-center space-x-2 text-sm">
                                <i data-lucide="arrow-down" class="w-4 h-4 text-amber-500"></i>
                                <span>1.5 MB/s</span>
                                <i data-lucide="arrow-up" class="w-4 h-4 text-blue-500 ml-4"></i>
                                <span>1.7 MB/s</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Charts Row -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-semibold">CPU & Memory Usage</h3>
                            <div class="flex space-x-2">
                                <button class="text-xs px-3 py-1 bg-slate-700 rounded-lg">1h</button>
                                <button class="text-xs px-3 py-1 bg-blue-500 rounded-lg">24h</button>
                                <button class="text-xs px-3 py-1 bg-slate-700 rounded-lg">7d</button>
                            </div>
                        </div>
                        <div class="h-64">
                            <canvas id="cpuMemoryChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-semibold">Network Traffic</h3>
                            <div class="flex space-x-2">
                                <button class="text-xs px-3 py-1 bg-slate-700 rounded-lg">1h</button>
                                <button class="text-xs px-3 py-1 bg-blue-500 rounded-lg">24h</button>
                                <button class="text-xs px-3 py-1 bg-slate-700 rounded-lg">7d</button>
                            </div>
                        </div>
                        <div class="h-64">
                            <canvas id="networkChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Projects Section -->
                <div class="bg-slate-800 rounded-2xl p-6 shadow-lg mb-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-semibold text-lg">Your Projects</h3>
                        <button id="new-project-btn" class="flex items-center space-x-2 bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg transition-colors">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            <span>New Project</span>
                        </button>
                    </div>
                    
                    <div id="projects-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Project cards will be added here -->
                    </div>
                </div>
            `;
            
            // Re-initialize icons and event listeners
            lucide.createIcons();
            initializeProjectButtons();
        }
        
        // Show projects content
        function showProjectsContent(mainContent) {
            if (!mainContent) return;
            
            mainContent.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 shadow-lg mb-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-semibold text-lg">All Projects</h3>
                        <button id="new-project-btn" class="flex items-center space-x-2 bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg transition-colors">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            <span>New Project</span>
                        </button>
                    </div>
                    
                    <div id="projects-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Project cards will be populated here -->
                    </div>
                </div>
                
                <!-- Project Statistics -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center space-x-4">
                            <div class="p-3 rounded-lg bg-green-500/10">
                                <i data-lucide="check-circle" class="w-8 h-8 text-green-500"></i>
                            </div>
                            <div>
                                <p class="text-slate-400 text-sm">Running Projects</p>
                                <h3 class="text-2xl font-bold">3</h3>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center space-x-4">
                            <div class="p-3 rounded-lg bg-red-500/10">
                                <i data-lucide="x-circle" class="w-8 h-8 text-red-500"></i>
                            </div>
                            <div>
                                <p class="text-slate-400 text-sm">Stopped Projects</p>
                                <h3 class="text-2xl font-bold">1</h3>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center space-x-4">
                            <div class="p-3 rounded-lg bg-blue-500/10">
                                <i data-lucide="folder" class="w-8 h-8 text-blue-500"></i>
                            </div>
                            <div>
                                <p class="text-slate-400 text-sm">Total Projects</p>
                                <h3 class="text-2xl font-bold">4</h3>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Re-initialize icons and event listeners
            lucide.createIcons();
            initializeProjectButtons();
        }
        
        // Show services content
        function showServicesContent(mainContent) {
            if (!mainContent) return;
            
            mainContent.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 shadow-lg mb-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-semibold text-lg">Docker Services</h3>
                        <div class="flex space-x-3">
                            <button id="new-service-btn" class="flex items-center space-x-2 bg-green-500 hover:bg-green-600 px-4 py-2 rounded-lg transition-colors">
                                <i data-lucide="plus" class="w-4 h-4"></i>
                                <span>New Service</span>
                            </button>
                            <button id="refresh-services-btn" class="flex items-center space-x-2 bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg transition-colors">
                                <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                                <span>Refresh</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <!-- Service Item -->
                        <div class="bg-slate-700/50 rounded-xl p-4 border border-slate-700">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center space-x-4">
                                    <div class="p-2 rounded-lg bg-blue-500/10">
                                        <i data-lucide="database" class="w-6 h-6 text-blue-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">PostgreSQL Database</h4>
                                        <p class="text-sm text-slate-400">postgres:13-alpine</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 rounded-full bg-emerald-400"></div>
                                        <span class="text-sm">Running</span>
                                    </div>
                                    <div class="flex space-x-2">
                                        <button class="text-slate-400 hover:text-red-400">
                                            <i data-lucide="square" class="w-4 h-4"></i>
                                        </button>
                                        <button class="text-slate-400 hover:text-blue-400">
                                            <i data-lucide="rotate-cw" class="w-4 h-4"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Service Item -->
                        <div class="bg-slate-700/50 rounded-xl p-4 border border-slate-700">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center space-x-4">
                                    <div class="p-2 rounded-lg bg-red-500/10">
                                        <i data-lucide="server" class="w-6 h-6 text-red-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Redis Cache</h4>
                                        <p class="text-sm text-slate-400">redis:6-alpine</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 rounded-full bg-emerald-400"></div>
                                        <span class="text-sm">Running</span>
                                    </div>
                                    <div class="flex space-x-2">
                                        <button class="text-slate-400 hover:text-red-400">
                                            <i data-lucide="square" class="w-4 h-4"></i>
                                        </button>
                                        <button class="text-slate-400 hover:text-blue-400">
                                            <i data-lucide="rotate-cw" class="w-4 h-4"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Service Item -->
                        <div class="bg-slate-700/50 rounded-xl p-4 border border-slate-700">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center space-x-4">
                                    <div class="p-2 rounded-lg bg-amber-500/10">
                                        <i data-lucide="globe" class="w-6 h-6 text-amber-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Nginx Proxy</h4>
                                        <p class="text-sm text-slate-400">nginx:alpine</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 rounded-full bg-red-400"></div>
                                        <span class="text-sm">Stopped</span>
                                    </div>
                                    <div class="flex space-x-2">
                                        <button class="text-slate-400 hover:text-green-400">
                                            <i data-lucide="play" class="w-4 h-4"></i>
                                        </button>
                                        <button class="text-slate-400 hover:text-blue-400">
                                            <i data-lucide="rotate-cw" class="w-4 h-4"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Service Statistics -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center space-x-4">
                            <div class="p-3 rounded-lg bg-green-500/10">
                                <i data-lucide="play-circle" class="w-8 h-8 text-green-500"></i>
                            </div>
                            <div>
                                <p class="text-slate-400 text-sm">Running</p>
                                <h3 class="text-2xl font-bold">2</h3>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center space-x-4">
                            <div class="p-3 rounded-lg bg-red-500/10">
                                <i data-lucide="pause-circle" class="w-8 h-8 text-red-500"></i>
                            </div>
                            <div>
                                <p class="text-slate-400 text-sm">Stopped</p>
                                <h3 class="text-2xl font-bold">1</h3>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center space-x-4">
                            <div class="p-3 rounded-lg bg-blue-500/10">
                                <i data-lucide="server" class="w-8 h-8 text-blue-500"></i>
                            </div>
                            <div>
                                <p class="text-slate-400 text-sm">Total Services</p>
                                <h3 class="text-2xl font-bold">3</h3>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center space-x-4">
                            <div class="p-3 rounded-lg bg-purple-500/10">
                                <i data-lucide="activity" class="w-8 h-8 text-purple-500"></i>
                            </div>
                            <div>
                                <p class="text-slate-400 text-sm">Uptime</p>
                                <h3 class="text-xl font-bold">99.9%</h3>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Re-initialize icons
            lucide.createIcons();
        }
        
        // Open terminal modal
        function openTerminalModal() {
            const terminalModal = document.getElementById('terminal-modal');
            if (terminalModal) {
                terminalModal.classList.remove('hidden');
                // Focus on terminal input
                const terminalInput = document.getElementById('terminal-input');
                if (terminalInput) {
                    setTimeout(() => terminalInput.focus(), 100);
                }
            }
        }
        
        // Open logs modal
        function openLogsModal() {
            const logsModal = document.getElementById('logs-modal');
            if (logsModal) {
                logsModal.classList.remove('hidden');
                // Add some sample logs
                addSampleLogs();
            }
        }
        
        // Add sample logs for demo
        function addSampleLogs() {
            const sampleLogs = [
                { level: 'info', message: 'Application started successfully', timestamp: new Date() },
                { level: 'info', message: 'Database connection established', timestamp: new Date(Date.now() - 60000) },
                { level: 'warn', message: 'High memory usage detected', timestamp: new Date(Date.now() - 120000) },
                { level: 'error', message: 'Failed to connect to external API', timestamp: new Date(Date.now() - 180000) }
            ];
            
            sampleLogs.forEach(log => addLogEntry(log));
        }
        
        // WebSocket connection for real-time updates
        let ws = null;
        let reconnectAttempts = 0;
        const maxReconnectAttempts = 5;
        
        // API Configuration
        const API_BASE_URL = 'http://localhost:3000';
        let authToken = localStorage.getItem('authToken');
        
        // WebSocket connection management
        function connectWebSocket() {
            if (ws && ws.readyState === WebSocket.OPEN) {
                return;
            }
            
            try {
                // Try to connect to WebSocket, but don't fail if backend is not running
                ws = new WebSocket('ws://localhost:3000/ws');
                
                ws.onopen = function() {
                    console.log('WebSocket connected');
                    reconnectAttempts = 0;
                    updateConnectionStatus(true);
                    
                    // Send authentication if token exists
                    if (authToken) {
                        ws.send(JSON.stringify({
                            type: 'auth',
                            token: authToken
                        }));
                    }
                };
                
                ws.onmessage = function(event) {
                    try {
                        const data = JSON.parse(event.data);
                        handleWebSocketMessage(data);
                    } catch (error) {
                        console.error('Error parsing WebSocket message:', error);
                    }
                };
                
                ws.onclose = function() {
                    console.log('WebSocket disconnected');
                    updateConnectionStatus(false);
                    
                    // Don't attempt to reconnect immediately to avoid spam
                    if (reconnectAttempts < maxReconnectAttempts) {
                        reconnectAttempts++;
                        setTimeout(connectWebSocket, 5000 * reconnectAttempts);
                    }
                };
                
                ws.onerror = function(error) {
                    console.log('WebSocket connection failed - backend may not be running');
                    updateConnectionStatus(false);
                };
                
            } catch (error) {
                console.log('WebSocket not available - running in demo mode');
                updateConnectionStatus(false);
            }
        }
        
        // Handle WebSocket messages
        function handleWebSocketMessage(data) {
            switch (data.type) {
                case 'metrics':
                    updateMetrics(data.payload);
                    break;
                case 'logs':
                    addLogEntry(data.payload);
                    break;
                case 'service_status':
                    updateServiceStatus(data.payload);
                    break;
                case 'terminal_output':
                    addTerminalOutput(data.payload);
                    break;
                default:
                    console.log('Unknown message type:', data.type);
            }
        }
        
        // Update connection status indicator
        function updateConnectionStatus(connected) {
            const statusIndicator = document.querySelector('.w-2.h-2.rounded-full');
            const statusText = statusIndicator ? statusIndicator.nextElementSibling : null;
            
            if (statusIndicator && statusText) {
                if (connected) {
                    statusIndicator.className = 'w-2 h-2 rounded-full bg-emerald-400 animate-pulse';
                    statusText.textContent = 'Connected';
                } else {
                    statusIndicator.className = 'w-2 h-2 rounded-full bg-red-400';
                    statusText.textContent = 'Disconnected';
                }
            } else {
                console.log('Connection status:', connected ? 'Connected' : 'Disconnected');
            }
        }
        
        // Update metrics from WebSocket
        function updateMetrics(metrics) {
            try {
                if (metrics.cpu !== undefined) {
                    const cpuCards = document.querySelectorAll('.bg-slate-800.rounded-2xl');
                    const cpuCard = cpuCards[0]; // First card is CPU
                    if (cpuCard) {
                        const cpuValue = cpuCard.querySelector('h3');
                        const cpuBar = cpuCard.querySelector('.h-2 div');
                        
                        if (cpuValue) cpuValue.textContent = `${Math.round(metrics.cpu)}%`;
                        if (cpuBar) cpuBar.style.width = `${Math.round(metrics.cpu)}%`;
                    }
                }
                
                if (metrics.memory !== undefined) {
                    const memCards = document.querySelectorAll('.bg-slate-800.rounded-2xl');
                    const memCard = memCards[1]; // Second card is Memory
                    if (memCard) {
                        const memValue = memCard.querySelector('h3');
                        const memBar = memCard.querySelector('.h-2 div');
                        
                        const memGB = (metrics.memory.used / (1024 * 1024 * 1024)).toFixed(1);
                        const totalGB = (metrics.memory.total / (1024 * 1024 * 1024)).toFixed(1);
                        const percentage = (metrics.memory.used / metrics.memory.total * 100).toFixed(1);
                        
                        if (memValue) memValue.textContent = `${memGB}/${totalGB} GB`;
                        if (memBar) memBar.style.width = `${percentage}%`;
                    }
                }
                
                if (metrics.network !== undefined) {
                    const netCards = document.querySelectorAll('.bg-slate-800.rounded-2xl');
                    const netCard = netCards[3]; // Fourth card is Network
                    if (netCard) {
                        const netValue = netCard.querySelector('h3');
                        
                        const downloadMB = (metrics.network.download / (1024 * 1024)).toFixed(1);
                        if (netValue) netValue.textContent = `${downloadMB} MB/s`;
                    }
                }
            } catch (error) {
                console.log('Error updating metrics:', error);
            }
        }
        
        // Add log entry to logs modal
        function addLogEntry(log) {
            const logsContent = document.getElementById('logs-content');
            if (!logsContent) return;
            
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${log.level} pl-3 mb-2`;
            
            const timestamp = new Date(log.timestamp).toLocaleString();
            logEntry.innerHTML = `
                <div class="text-${log.level === 'error' ? 'red' : log.level === 'warn' ? 'amber' : 'blue'}-400">[${log.level.toUpperCase()}] ${timestamp}</div>
                <div>${log.message}</div>
            `;
            
            logsContent.appendChild(logEntry);
            logsContent.scrollTop = logsContent.scrollHeight;
            
            // Keep only last 100 log entries
            const logEntries = logsContent.querySelectorAll('.log-entry');
            if (logEntries.length > 100) {
                logEntries[0].remove();
            }
        }
        
        // Update service status
        function updateServiceStatus(status) {
            // Find project card and update status
            const projectCards = document.querySelectorAll('.bg-slate-700/50');
            projectCards.forEach(card => {
                const projectName = card.querySelector('h4').textContent;
                if (projectName === status.projectName) {
                    const statusIndicator = card.querySelector('.w-2.h-2');
                    const statusText = statusIndicator.nextElementSibling;
                    
                    switch (status.status) {
                        case 'running':
                            statusIndicator.className = 'w-2 h-2 rounded-full bg-emerald-400';
                            statusText.textContent = 'Running';
                            break;
                        case 'stopped':
                            statusIndicator.className = 'w-2 h-2 rounded-full bg-red-400';
                            statusText.textContent = 'Stopped';
                            break;
                        case 'restarting':
                            statusIndicator.className = 'w-2 h-2 rounded-full bg-amber-400';
                            statusText.textContent = 'Restarting';
                            break;
                    }
                }
            });
        }
        
        // Add terminal output
        function addTerminalOutput(output) {
            const terminalContent = document.getElementById('terminal-content');
            if (!terminalContent) return;
            
            const line = document.createElement('div');
            line.className = 'terminal-line';
            line.textContent = output.text;
            
            terminalContent.appendChild(line);
            terminalContent.scrollTop = terminalContent.scrollHeight;
        }
        
        // API functions
        async function apiRequest(endpoint, options = {}) {
            const url = `${API_BASE_URL}${endpoint}`;
            const headers = {
                'Content-Type': 'application/json',
                ...options.headers
            };
            
            if (authToken) {
                headers.Authorization = `Bearer ${authToken}`;
            }
            
            try {
                const response = await fetch(url, {
                    ...options,
                    headers
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error('API request failed:', error);
                throw error;
            }
        }
        
        // Load projects from API
        async function loadProjects() {
            try {
                const projects = await apiRequest('/projects');
                updateProjectsDisplay(projects);
            } catch (error) {
                console.error('Failed to load projects:', error);
            }
        }
        
        // Update projects display
        function updateProjectsDisplay(projects) {
            const projectsContainer = document.querySelector('.grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3');
            if (!projectsContainer || !projects) return;
            
            projectsContainer.innerHTML = '';
            
            projects.forEach(project => {
                const projectCard = createProjectCard(project);
                projectsContainer.appendChild(projectCard);
            });
        }
        
        // Create project card element
        function createProjectCard(project) {
            const card = document.createElement('div');
            card.className = 'bg-slate-700/50 rounded-xl p-4 border border-slate-700 hover:border-slate-600 transition-colors';
            
            const statusColor = project.status === 'running' ? 'emerald' : project.status === 'stopped' ? 'red' : 'amber';
            
            card.innerHTML = `
                <div class="flex justify-between items-start">
                    <div>
                        <h4 class="font-medium">${project.name}</h4>
                        <p class="text-sm text-slate-400 mt-1">${project.description || 'No description'}</p>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-2 h-2 rounded-full bg-${statusColor}-400"></div>
                        <span class="text-xs">${project.status || 'Unknown'}</span>
                    </div>
                </div>
                <div class="mt-4 pt-4 border-t border-slate-700 flex justify-between">
                    <div class="text-xs flex items-center space-x-2 text-slate-400">
                        <i data-lucide="clock" class="w-3 h-3"></i>
                        <span>Updated ${new Date(project.updated_at).toLocaleDateString()}</span>
                    </div>
                    <div class="flex space-x-2">
                        <button class="text-slate-400 hover:text-blue-400" onclick="startProject('${project.id}')">
                            <i data-lucide="play" class="w-4 h-4"></i>
                        </button>
                        <button class="text-slate-400 hover:text-red-400" onclick="stopProject('${project.id}')">
                            <i data-lucide="stop-circle" class="w-4 h-4"></i>
                        </button>
                        <button class="text-slate-400 hover:text-white" onclick="openProjectSettings('${project.id}')">
                            <i data-lucide="settings" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            `;
            
            return card;
        }
        
        // Project control functions
        async function startProject(projectId) {
            try {
                await apiRequest(`/services/${projectId}/services/start`, { method: 'POST' });
                console.log('Project started:', projectId);
            } catch (error) {
                console.error('Failed to start project:', error);
            }
        }
        
        async function stopProject(projectId) {
            try {
                await apiRequest(`/services/${projectId}/services/stop`, { method: 'POST' });
                console.log('Project stopped:', projectId);
            } catch (error) {
                console.error('Failed to stop project:', error);
            }
        }
        
        function openProjectSettings(projectId) {
            console.log('Opening settings for project:', projectId);
            // TODO: Implement settings modal
        }
        
        // Initialize WebSocket connection on page load
        connectWebSocket();
        
        // Load initial data
        loadInitialData();
        
        // Load initial data from API
        async function loadInitialData() {
            try {
                // For now, we'll use mock data since we don't have authentication yet
                // In a real implementation, you'd load projects from the API
                console.log('Loading initial data...');
                
                // Try to load system metrics
                loadSystemMetrics();
            } catch (error) {
                console.error('Failed to load initial data:', error);
            }
        }
        
        // Initialize New Project and New Service buttons
        function initializeNewButtons() {
            // New Project button
            document.addEventListener('click', (e) => {
                if (e.target.id === 'new-project-btn' || e.target.closest('#new-project-btn')) {
                    openNewProjectModal();
                }
                
                // New Service button (dedicated button)
                if (e.target.id === 'new-service-btn' || e.target.closest('#new-service-btn')) {
                    openNewServiceModal();
                }
                
                // Refresh Services button
                if (e.target.id === 'refresh-services-btn' || e.target.closest('#refresh-services-btn')) {
                    refreshServices();
                }
            });
        }
                
                // Open New Project Modal
                function openNewProjectModal() {
                    const modal = document.createElement('div');
                    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                    modal.innerHTML = `
                        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-md mx-4">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-xl font-semibold">Create New Project</h3>
                                <button id="close-project-modal" class="text-slate-400 hover:text-white">
                                    <i data-lucide="x" class="w-6 h-6"></i>
                                </button>
                            </div>
                            
                            <form id="new-project-form" class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Project Name</label>
                                    <input type="text" id="project-name" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="My Awesome Project" required>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium mb-2">Technology Stack</label>
                                    <input type="text" id="project-stack" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="nextjs, postgres, redis" required>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium mb-2">Description</label>
                                    <textarea id="project-description" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" rows="3" placeholder="Brief description of your project"></textarea>
                                </div>
                                
                                <div class="flex space-x-3 pt-4">
                                    <button type="submit" class="flex-1 bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg transition-colors">
                                        Create Project
                                    </button>
                                    <button type="button" id="cancel-project" class="flex-1 bg-slate-600 hover:bg-slate-700 px-4 py-2 rounded-lg transition-colors">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    `;
                    
                    document.body.appendChild(modal);
                    lucide.createIcons();
                    
                    // Close modal events
                    modal.querySelector('#close-project-modal').addEventListener('click', () => {
                        document.body.removeChild(modal);
                    });
                    
                    modal.querySelector('#cancel-project').addEventListener('click', () => {
                        document.body.removeChild(modal);
                    });
                    
                    // Form submission
                    modal.querySelector('#new-project-form').addEventListener('submit', (e) => {
                        e.preventDefault();
                        const formData = {
                            name: modal.querySelector('#project-name').value,
                            stack: modal.querySelector('#project-stack').value,
                            description: modal.querySelector('#project-description').value
                        };
                        
                        createNewProject(formData);
                        document.body.removeChild(modal);
                    });
                    
                    // Focus on first input
                    setTimeout(() => modal.querySelector('#project-name').focus(), 100);
                }
                
                // Create new project
                function createNewProject(projectData) {
                    const projectsGrid = document.getElementById('projects-grid');
                    if (!projectsGrid) {
                        // If not in projects section, add to dashboard projects section
                        const dashboardProjectsGrid = document.querySelector('.grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3.gap-4');
                        if (dashboardProjectsGrid) {
                            addProjectCard(dashboardProjectsGrid, projectData);
                        }
                    } else {
                        addProjectCard(projectsGrid, projectData);
                    }
                    
                    showNotification(`Project "${projectData.name}" created successfully!`, 'success');
                }
                
                // Add project card to grid
                function addProjectCard(grid, projectData) {
                    const projectCard = document.createElement('div');
                    projectCard.className = 'bg-slate-700/50 rounded-xl p-4 border border-slate-700 hover:border-slate-600 transition-colors';
                    projectCard.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-medium">${projectData.name}</h4>
                                <p class="text-sm text-slate-400 mt-1">${projectData.stack}</p>
                                ${projectData.description ? `<p class="text-xs text-slate-500 mt-2">${projectData.description}</p>` : ''}
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 rounded-full bg-amber-400"></div>
                                <span class="text-xs">Creating</span>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-slate-700 flex justify-between">
                            <div class="text-xs flex items-center space-x-2 text-slate-400">
                                <i data-lucide="clock" class="w-3 h-3"></i>
                                <span>Just created</span>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-slate-400 hover:text-green-400" onclick="startProject('${projectData.name}')">
                                    <i data-lucide="play" class="w-4 h-4"></i>
                                </button>
                                <button class="text-slate-400 hover:text-red-400" onclick="stopProject('${projectData.name}')">
                                    <i data-lucide="square" class="w-4 h-4"></i>
                                </button>
                                <button class="text-slate-400 hover:text-blue-400" onclick="openProjectSettings('${projectData.name}')">
                                    <i data-lucide="settings" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    
                    grid.appendChild(projectCard);
                    lucide.createIcons();
                    
                    // Simulate project creation process
                    setTimeout(() => {
                        const statusIndicator = projectCard.querySelector('.w-2.h-2');
                        const statusText = statusIndicator.nextElementSibling;
                        if (statusIndicator && statusText) {
                            statusIndicator.className = 'w-2 h-2 rounded-full bg-emerald-400';
                            statusText.textContent = 'Ready';
                        }
                    }, 2000);
                }
                
        // Open New Service Modal
        function openNewServiceModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-md mx-4">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold">Create New Service</h3>
                        <button id="close-service-modal" class="text-slate-400 hover:text-white">
                            <i data-lucide="x" class="w-6 h-6"></i>
                        </button>
                    </div>
                    
                    <form id="new-service-form" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Service Name</label>
                            <input type="text" id="service-name" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="My Service" required>
                        </div>
                        
                        <!-- Dynamic Configuration Fields -->
                        <div id="service-config-fields">
                            <div>
                                <label class="block text-sm font-medium mb-2">Docker Image</label>
                                <input type="text" id="service-image" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="e.g., nginx:latest">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium mb-2">Port (Optional)</label>
                                <input type="number" id="service-port" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="e.g., 3000">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Project</label>
                            <select id="service-project" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" required>
                                <option value="">Select project</option>
                                <option value="ecommerce">E-commerce Platform</option>
                                <option value="blog">Personal Blog</option>
                                <option value="api">REST API</option>
                                <option value="dashboard">Analytics Dashboard</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Service Type</label>
                            <select id="service-type" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" required>
                                <option value="">Select service type</option>
                                <option value="aplicativo">Aplicativo</option>
                                <option value="supabase">Supabase (Template)</option>
                                <option value="postgres">Postgres (Template)</option>
                                <option value="redis">Redis (Template)</option>
                                <option value="box-nodejs">Box Nodejs (Template)</option>
                                <option value="box-nextjs">Box Nextjs (Template)</option>
                                <option value="database">Database</option>
                                <option value="cache">Cache</option>
                                <option value="web">Web Server</option>
                                <option value="api">API Service</option>
                                <option value="queue">Message Queue</option>
                                <option value="monitoring">Monitoring</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Port (Optional)</label>
                            <input type="number" id="service-port" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="8080">
                        </div>
                        
                        <div class="flex space-x-3 pt-4">
                            <button type="submit" class="flex-1 bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg transition-colors">
                                Create Service
                            </button>
                            <button type="button" id="cancel-service" class="flex-1 bg-slate-600 hover:bg-slate-700 px-4 py-2 rounded-lg transition-colors">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            document.body.appendChild(modal);
            lucide.createIcons();
            
            // Close modal events
            modal.querySelector('#close-service-modal').addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            modal.querySelector('#cancel-service').addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            // Form submission
            modal.querySelector('#new-service-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const serviceType = modal.querySelector('#service-type').value;
                const serviceName = modal.querySelector('#service-name').value;
                
                // Auto-fill templates based on service type
                const templates = {
                    'supabase': {
                        image: 'supabase/postgres:latest',
                        port: '5432',
                        env: 'POSTGRES_DB=supabase,POSTGRES_USER=postgres,POSTGRES_PASSWORD=postgres'
                    },
                    'postgres': {
                        image: 'postgres:15-alpine',
                        port: '5432',
                        env: 'POSTGRES_DB=mydb,POSTGRES_USER=postgres,POSTGRES_PASSWORD=postgres'
                    },
                    'redis': {
                        image: 'redis:7-alpine',
                        port: '6379',
                        env: 'REDIS_PASSWORD=redis123'
                    },
                    'box-nodejs': {
                        image: 'node:18-alpine',
                        port: '3000',
                        env: 'NODE_ENV=development,PORT=3000'
                    },
                    'box-nextjs': {
                        image: 'node:18-alpine',
                        port: '3000',
                        env: 'NODE_ENV=development,NEXT_PUBLIC_API_URL=http://localhost:3000'
                    }
                };
                
                const template = templates[serviceType];
                const formData = {
                    name: serviceName,
                    image: template ? template.image : modal.querySelector('#service-image').value,
                    project: modal.querySelector('#service-project').value,
                    type: serviceType,
                    port: template ? template.port : modal.querySelector('#service-port').value,
                    env: template ? template.env : null,
                    isTemplate: !!template
                };
                
                createNewService(formData);
                document.body.removeChild(modal);
            });
            
            // Add service type change listener
            const serviceTypeSelect = modal.querySelector('#service-type');
            serviceTypeSelect.addEventListener('change', updateServiceConfigFields);
            
            // Focus on first input
            setTimeout(() => modal.querySelector('#service-name').focus(), 100);
        }
        
        // Function to update service configuration fields based on type
        function updateServiceConfigFields() {
            const serviceType = document.querySelector('#service-type').value;
            const configFields = document.querySelector('#service-config-fields');
            
            if (serviceType === 'aplicativo') {
                configFields.innerHTML = `
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">Deployment Method</label>
                        <select id="deployment-method" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" required>
                            <option value="">Select deployment method</option>
                            <option value="zip">Upload ZIP File</option>
                            <option value="github">GitHub Repository</option>
                            <option value="upload">Manual Upload</option>
                            <option value="docker">Docker Image</option>
                            <option value="git">Git Clone</option>
                            <option value="dockerfile">Custom Dockerfile</option>
                        </select>
                    </div>
                    
                    <div id="deployment-config">
                        <!-- Dynamic fields based on deployment method -->
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">Port</label>
                        <input type="number" id="service-port" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="e.g., 3000" value="3000">
                    </div>
                `;
                
                // Add deployment method change listener
                const deploymentMethod = document.querySelector('#deployment-method');
                deploymentMethod.addEventListener('change', updateDeploymentConfig);
            } else {
                // Default fields for other service types
                configFields.innerHTML = `
                    <div>
                        <label class="block text-sm font-medium mb-2">Docker Image</label>
                        <input type="text" id="service-image" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="e.g., nginx:latest">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">Port (Optional)</label>
                        <input type="number" id="service-port" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="e.g., 3000">
                    </div>
                `;
            }
        }
        
        // Function to update deployment configuration fields
        function updateDeploymentConfig() {
            const deploymentMethod = document.querySelector('#deployment-method').value;
            const deploymentConfig = document.querySelector('#deployment-config');
            
            switch(deploymentMethod) {
                case 'zip':
                    deploymentConfig.innerHTML = `
                        <div class="border-2 border-dashed border-slate-600 rounded-lg p-6 text-center mb-4">
                            <i data-lucide="upload" class="w-8 h-8 mx-auto mb-2 text-slate-400"></i>
                            <p class="text-sm text-slate-400 mb-2">Drag & drop your ZIP file here</p>
                            <input type="file" id="zip-file" accept=".zip" class="hidden">
                            <button type="button" onclick="document.getElementById('zip-file').click()" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 rounded-lg text-sm">Choose ZIP File</button>
                        </div>
                    `;
                    break;
                    
                case 'github':
                    deploymentConfig.innerHTML = `
                        <div>
                            <label class="block text-sm font-medium mb-2">GitHub Repository URL</label>
                            <input type="url" id="github-url" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="https://github.com/user/repo.git" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Branch (Optional)</label>
                            <input type="text" id="github-branch" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="main" value="main">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Access Token (Private repos)</label>
                            <input type="password" id="github-token" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="ghp_xxxxxxxxxxxx">
                        </div>
                    `;
                    break;
                    
                case 'upload':
                    deploymentConfig.innerHTML = `
                        <div class="border-2 border-dashed border-slate-600 rounded-lg p-6 text-center mb-4">
                            <i data-lucide="folder-plus" class="w-8 h-8 mx-auto mb-2 text-slate-400"></i>
                            <p class="text-sm text-slate-400 mb-2">Upload your application files</p>
                            <input type="file" id="upload-files" multiple class="hidden">
                            <button type="button" onclick="document.getElementById('upload-files').click()" class="px-4 py-2 bg-green-500 hover:bg-green-600 rounded-lg text-sm">Choose Files</button>
                        </div>
                    `;
                    break;
                    
                case 'docker':
                    deploymentConfig.innerHTML = `
                        <div>
                            <label class="block text-sm font-medium mb-2">Docker Image</label>
                            <input type="text" id="docker-image" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="nginx:latest" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Registry (Optional)</label>
                            <input type="text" id="docker-registry" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="docker.io">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Environment Variables</label>
                            <textarea id="docker-env" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" rows="3" placeholder="KEY1=value1\nKEY2=value2"></textarea>
                        </div>
                    `;
                    break;
                    
                case 'git':
                    deploymentConfig.innerHTML = `
                        <div>
                            <label class="block text-sm font-medium mb-2">Git Repository URL</label>
                            <input type="url" id="git-url" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="https://git.example.com/user/repo.git" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Branch</label>
                            <input type="text" id="git-branch" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="main" value="main">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Build Command</label>
                            <input type="text" id="git-build" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="npm run build">
                        </div>
                    `;
                    break;
                    
                case 'dockerfile':
                    deploymentConfig.innerHTML = `
                        <div>
                            <label class="block text-sm font-medium mb-2">Dockerfile Content</label>
                            <textarea id="dockerfile-content" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500 font-mono text-sm" rows="8" placeholder="FROM node:18-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm install\nCOPY . .\nEXPOSE 3000\nCMD [&quot;npm&quot;, &quot;start&quot;]" required></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Build Context (Optional)</label>
                            <input type="text" id="dockerfile-context" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" placeholder="." value=".">
                        </div>
                    `;
                    break;
                    
                default:
                    deploymentConfig.innerHTML = '';
            }
            
            // Re-initialize Lucide icons
            lucide.createIcons();
        }
        
        // Create new service
        function createNewService(serviceData) {
            // Get the services container
            const servicesContainer = document.querySelector('.space-y-4');
            if (!servicesContainer) {
                showNotification('Please navigate to Services section first', 'error');
                return;
            }
            
            // Get service color based on type
            const getServiceColor = (type) => {
                switch(type) {
                    case 'aplicativo': return 'indigo';
                    case 'supabase': return 'green';
                    case 'postgres': return 'blue';
                    case 'redis': return 'red';
                    case 'box-nodejs': return 'emerald';
                    case 'box-nextjs': return 'slate';
                    case 'database': return 'blue';
                    case 'cache': return 'purple';
                    case 'web': return 'green';
                    case 'api': return 'amber';
                    case 'queue': return 'red';
                    case 'monitoring': return 'emerald';
                    default: return 'slate';
                }
            };
            
            const icon = getServiceIcon(serviceData.type);
            const color = getServiceColor(serviceData.type);
            
            const serviceItem = document.createElement('div');
            serviceItem.className = 'bg-slate-700/50 rounded-xl p-4 border border-slate-700';
            serviceItem.innerHTML = `
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <div class="p-2 rounded-lg bg-${color}-500/10">
                            <i data-lucide="${icon}" class="w-6 h-6 text-${color}-500"></i>
                        </div>
                        <div>
                            <h4 class="font-medium">${serviceData.name}</h4>
                            <p class="text-sm text-slate-400">${serviceData.image}</p>
                            <p class="text-xs text-blue-400">Project: ${serviceData.project}</p>
                            ${serviceData.port ? `<p class="text-xs text-slate-500">Port: ${serviceData.port}</p>` : ''}
                            ${serviceData.isTemplate ? `<p class="text-xs text-green-400"> Template Applied</p>` : ''}
                            ${serviceData.env ? `<p class="text-xs text-amber-400">ENV: ${serviceData.env.split(',')[0]}...</p>` : ''}
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2">
                            <div class="w-2 h-2 rounded-full bg-amber-400"></div>
                            <span class="text-sm">Creating</span>
                        </div>
                        <div class="flex space-x-2">
                            <button class="text-slate-400 hover:text-green-400" onclick="startService('${serviceData.name}')">
                                <i data-lucide="play" class="w-4 h-4"></i>
                            </button>
                            <button class="text-slate-400 hover:text-red-400" onclick="stopService('${serviceData.name}')">
                                <i data-lucide="square" class="w-4 h-4"></i>
                            </button>
                            <button class="text-slate-400 hover:text-blue-400" onclick="restartService('${serviceData.name}')">
                                <i data-lucide="rotate-cw" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            servicesContainer.appendChild(serviceItem);
            lucide.createIcons();
            
            // Simulate service creation process
            setTimeout(() => {
                const statusIndicator = serviceItem.querySelector('.w-2.h-2');
                const statusText = statusIndicator.nextElementSibling;
                if (statusIndicator && statusText) {
                    statusIndicator.className = 'w-2 h-2 rounded-full bg-emerald-400';
                    statusText.textContent = 'Running';
                }
            }, 3000);
            
            showNotification(`Service "${serviceData.name}" created successfully!`, 'success');
        }
        
        // Service control functions
        function startService(serviceName) {
            showNotification(`Starting service: ${serviceName}`, 'info');
            // Here you would call the backend API
        }
        
        function stopService(serviceName) {
            showNotification(`Stopping service: ${serviceName}`, 'info');
            // Here you would call the backend API
        }
        
        function restartService(serviceName) {
            showNotification(`Restarting service: ${serviceName}`, 'info');
            // Here you would call the backend API
        }
        
        // Refresh Services function
        function refreshServices() {
            showNotification('Refreshing services...', 'info');
            
            // Simulate refresh with loading state
            const refreshBtn = document.getElementById('refresh-services-btn');
            if (refreshBtn) {
                const originalContent = refreshBtn.innerHTML;
                refreshBtn.innerHTML = `
                    <i data-lucide="loader-2" class="w-4 h-4 animate-spin"></i>
                    <span>Refreshing...</span>
                `;
                refreshBtn.disabled = true;
                
                // Re-initialize icons for the spinner
                lucide.createIcons();
                
                // Simulate API call delay
                setTimeout(() => {
                    refreshBtn.innerHTML = originalContent;
                    refreshBtn.disabled = false;
                    lucide.createIcons();
                    showNotification('Services refreshed successfully!', 'success');
                    
                    // Here you would call the backend API to refresh services
                    // Example: loadServicesFromAPI();
                }, 2000);
            }
        }
                
        // Load initial data when page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Loading initial data...');
            loadInitialData();
            connectWebSocket();
            initializeNewButtons();
        });
        
        // Load system metrics
        async function loadSystemMetrics() {
            try {
                // For demo, we'll simulate metrics since we need authentication
                const mockMetrics = {
                    cpu: Math.random() * 100,
                    memory: {
                        used: Math.random() * 8 * 1024 * 1024 * 1024,
                        total: 16 * 1024 * 1024 * 1024
                    },
                    network: {
                        download: Math.random() * 5 * 1024 * 1024
                    }
                };
                updateMetrics(mockMetrics);
            } catch (error) {
                console.error('Failed to load system metrics:', error);
            }
        }
        
        // Toggle sidebar
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const sidebar = document.getElementById('sidebar');
        
        sidebarToggle.addEventListener('click', () => {
            sidebar.classList.toggle('sidebar-collapsed');
        });
        
        // Navigation functionality
        // Sidebar navigation
        document.querySelectorAll('.nav-item').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const target = e.target.closest('a'); // Get the anchor element
                if (!target) return;
                
                const section = target.getAttribute('data-section');
                if (section) {
                    showSection(section);
                    
                    // Update active state
                    document.querySelectorAll('.nav-item').forEach(l => {
                        l.classList.remove('bg-slate-700', 'text-blue-400');
                    });
                    target.classList.add('bg-slate-700', 'text-blue-400');
                }
            });
        });
        
        // Navigation functions are handled by showSection() function above
        
        // Terminal modal
        const terminalModal = document.getElementById('terminal-modal');
        const closeTerminal = document.getElementById('close-terminal');
        
        // For demo purposes, we'll simulate opening the terminal
        setTimeout(() => {
            // terminalModal.classList.remove('hidden');
        }, 2000);
        
        closeTerminal.addEventListener('click', () => {
            terminalModal.classList.add('hidden');
        });
        
        // Terminal command functionality
        const terminalInput = document.querySelector('#terminal-modal input');
        const terminalSendBtn = document.querySelector('#terminal-modal button');
        
        function sendTerminalCommand() {
            const command = terminalInput.value.trim();
            if (!command) return;
            
            // Add command to terminal output
            addTerminalOutput({ text: `$ ${command}` });
            
            // Send command via WebSocket if connected
            if (ws && ws.readyState === WebSocket.OPEN) {
                ws.send(JSON.stringify({
                    type: 'terminal_command',
                    command: command,
                    serviceId: 'demo-service'
                }));
            } else {
                // Simulate command execution for demo
                setTimeout(() => {
                    addTerminalOutput({ text: simulateCommandOutput(command) });
                }, 200);
            }
            
            terminalInput.value = '';
        }
        
        // Simulate command output for demo
        function simulateCommandOutput(command) {
            const responses = {
                'ls': 'index.js  package.json  node_modules  src',
                'pwd': '/app',
                'whoami': 'root',
                'ps': 'PID   COMMAND\n1     node index.js\n25    bash',
                'date': new Date().toString(),
                'uptime': 'up 2 days, 4 hours, 15 minutes'
            };
            
            return responses[command] || `Command '${command}' executed successfully`;
        }
        
        terminalSendBtn.addEventListener('click', sendTerminalCommand);
        terminalInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendTerminalCommand();
            }
        });
        
        // Logs modal
        const logsModal = document.getElementById('logs-modal');
        const closeLogs = document.getElementById('close-logs');
        
        // For demo purposes, we'll simulate opening the logs
        setTimeout(() => {
            // logsModal.classList.remove('hidden');
        }, 3000);
        
        closeLogs.addEventListener('click', () => {
            logsModal.classList.add('hidden');
        });
        
        // New Project button functionality
        const newProjectBtn = document.querySelector('button:has(i[data-lucide="plus"])');
        if (newProjectBtn) {
            newProjectBtn.addEventListener('click', () => {
                showNewProjectModal();
            });
        }
        
        // Show new project modal
        function showNewProjectModal() {
            const projectName = prompt('Enter project name:');
            if (projectName && projectName.trim()) {
                createNewProject(projectName.trim());
            }
        }
        
        // Create new project
        async function createNewProject(name) {
            try {
                console.log(`Creating new project: ${name}`);
                
                // For demo, add a new project card
                const projectsContainer = document.querySelector('.grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3');
                const newProject = {
                    id: Date.now().toString(),
                    name: name,
                    description: 'New project created',
                    status: 'stopped',
                    updated_at: new Date().toISOString()
                };
                
                const projectCard = createProjectCard(newProject);
                projectsContainer.appendChild(projectCard);
                
                // Re-initialize Lucide icons for new elements
                lucide.createIcons();
                
                alert(`Project "${name}" created successfully!`);
            } catch (error) {
                console.error('Failed to create project:', error);
                alert('Failed to create project. Please try again.');
            }
        }
        
        // Enhanced project control functions with user feedback
        window.startProject = async function(projectId) {
            try {
                console.log('Starting project:', projectId);
                
                // Update UI to show starting state
                updateProjectStatus(projectId, 'starting', 'amber');
                
                // Simulate API call
                setTimeout(() => {
                    updateProjectStatus(projectId, 'running', 'emerald');
                    showNotification('Project started successfully!', 'success');
                }, 1000);
                
            } catch (error) {
                console.error('Failed to start project:', error);
                showNotification('Failed to start project', 'error');
            }
        }
        
        window.stopProject = async function(projectId) {
            try {
                console.log('Stopping project:', projectId);
                
                // Update UI to show stopping state
                updateProjectStatus(projectId, 'stopping', 'amber');
                
                // Simulate API call
                setTimeout(() => {
                    updateProjectStatus(projectId, 'stopped', 'red');
                    showNotification('Project stopped successfully!', 'success');
                }, 1000);
                
            } catch (error) {
                console.error('Failed to stop project:', error);
                showNotification('Failed to stop project', 'error');
            }
        }
        
        window.openProjectSettings = function(projectId) {
            console.log('Opening settings for project:', projectId);
            const settings = prompt('Project Settings (JSON format):', '{}');
            if (settings) {
                try {
                    JSON.parse(settings);
                    showNotification('Settings updated successfully!', 'success');
                } catch (error) {
                    showNotification('Invalid JSON format', 'error');
                }
            }
        }
        
        // Update project status in UI
        function updateProjectStatus(projectId, status, color) {
            const projectCards = document.querySelectorAll('.bg-slate-700\/50');
            projectCards.forEach(card => {
                const buttons = card.querySelectorAll('button');
                buttons.forEach(button => {
                    if (button.onclick && button.onclick.toString().includes(projectId)) {
                        const statusIndicator = card.querySelector('.w-2.h-2');
                        const statusText = statusIndicator.nextElementSibling;
                        
                        statusIndicator.className = `w-2 h-2 rounded-full bg-${color}-400`;
                        statusText.textContent = status.charAt(0).toUpperCase() + status.slice(1);
                    }
                });
            });
        }
        
        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-emerald-500' : 
                type === 'error' ? 'bg-red-500' : 'bg-blue-500'
            } text-white`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // Charts
        // CPU & Memory Chart
        const cpuMemoryCtx = document.getElementById('cpuMemoryChart').getContext('2d');
        const cpuMemoryChart = new Chart(cpuMemoryCtx, {
            type: 'line',
            data: {
                labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                datasets: [
                    {
                        label: 'CPU Usage',
                        data: [12, 15, 18, 22, 28, 35, 42, 38, 32, 28, 25, 22, 20, 18, 22, 28, 35, 42, 48, 52, 45, 38, 32, 28],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Memory Usage',
                        data: [18, 20, 22, 25, 28, 30, 32, 30, 28, 26, 24, 22, 20, 22, 25, 28, 32, 35, 38, 42, 38, 35, 32, 30],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            color: '#e2e8f0'
                        }
                    }
                },
                scales: {
                    x: {
                        grid: {
                            color: 'rgba(71, 85, 105, 0.3)'
                        },
                        ticks: {
                            color: '#94a3b8'
                        }
                    },
                    y: {
                        grid: {
                            color: 'rgba(71, 85, 105, 0.3)'
                        },
                        ticks: {
                            color: '#94a3b8',
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                }
            }
        });
        
        // Network Chart
        const networkCtx = document.getElementById('networkChart').getContext('2d');
        const networkChart = new Chart(networkCtx, {
            type: 'bar',
            data: {
                labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                datasets: [
                    {
                        label: 'Download',
                        data: [1.2, 1.0, 0.8, 0.7, 0.6, 0.8, 1.2, 1.8, 2.5, 3.2, 3.5, 3.8, 3.5, 3.2, 3.0, 3.2, 3.5, 3.8, 4.2, 4.5, 4.0, 3.5, 3.0, 2.5],
                        borderColor: '#f59e0b',
                        backgroundColor: 'rgba(245, 158, 11, 0.5)',
                    },
                    {
                        label: 'Upload',
                        data: [0.8, 0.7, 0.6, 0.5, 0.4, 0.6, 0.9, 1.5, 2.0, 2.5, 2.8, 3.0, 2.8, 2.5, 2.2, 2.5, 2.8, 3.0, 3.5, 3.8, 3.2, 2.8, 2.5, 2.0],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.5)',
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            color: '#e2e8f0'
                        }
                    }
                },
                scales: {
                    x: {
                        stacked: false,
                        grid: {
                            color: 'rgba(71, 85, 105, 0.3)'
                        },
                        ticks: {
                            color: '#94a3b8'
                        }
                    },
                    y: {
                        stacked: false,
                        grid: {
                            color: 'rgba(71, 85, 105, 0.3)'
                        },
                        ticks: {
                            color: '#94a3b8',
                            callback: function(value) {
                                return value + ' MB/s';
                            }
                        }
                    }
                }
            }
        });
        
        // Simulate real-time updates
        setInterval(() => {
            // Update CPU usage
            const cpuUsage = Math.min(100, Math.max(0, cpuMemoryChart.data.datasets[0].data[23] + (Math.random() * 6 - 3)));
            cpuMemoryChart.data.datasets[0].data.shift();
            cpuMemoryChart.data.datasets[0].data.push(Math.round(cpuUsage));
            
            // Update Memory usage
            const memUsage = Math.min(100, Math.max(0, cpuMemoryChart.data.datasets[1].data[23] + (Math.random() * 4 - 2)));
            cpuMemoryChart.data.datasets[1].data.shift();
            cpuMemoryChart.data.datasets[1].data.push(Math.round(memUsage));
            
            cpuMemoryChart.update();
            
            // Update Network data
            const download = Math.max(0, networkChart.data.datasets[0].data[23] + (Math.random() * 0.6 - 0.3));
            networkChart.data.datasets[0].data.shift();
            networkChart.data.datasets[0].data.push(Math.round(download * 10) / 10);
            
            const upload = Math.max(0, networkChart.data.datasets[1].data[23] + (Math.random() * 0.4 - 0.2));
            networkChart.data.datasets[1].data.shift();
            networkChart.data.datasets[1].data.push(Math.round(upload * 10) / 10);
            
            networkChart.update();
            
            // Update stats cards
            document.querySelector('.bg-slate-800:nth-child(1) h3').textContent = `${Math.round(cpuUsage)}%`;
            document.querySelector('.bg-slate-800:nth-child(1) .h-2 div').style.width = `${Math.round(cpuUsage)}%`;
            
            const memGB = (5.2 + (Math.random() * 0.4 - 0.2)).toFixed(1);
            document.querySelector('.bg-slate-800:nth-child(2) h3').textContent = `${memGB}/16 GB`;
            document.querySelector('.bg-slate-800:nth-child(2) .h-2 div').style.width = `${(parseFloat(memGB) / 16 * 100).toFixed(1)}%`;
            
            document.querySelector('.bg-slate-800:nth-child(4) h3').textContent = `${download.toFixed(1)} MB/s`;
            
        }, 3000);
    </script>
</body>
</html>